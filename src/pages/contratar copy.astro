---
import Layout from '../layouts/Layout.astro';

import EmpresarialButton from '../components/buttons/EmpresarialButton.astro';
import TestimoniosButton from '../components/buttons/TestimoniosButton.astro';
import HomeButton from '../components/buttons/HomeButton.astro';
import CardPaquetesContratar from '../components/CardPaquetesContratar.astro';

---

<script>
    function validatePhoneNumber(phoneNumber:string) {
            // Ajusta la expresión regular según el formato que necesites
            const phoneRegex = /^\d{10}$/; // Ejemplo: 10 dígitos
            return phoneRegex.test(phoneNumber);
        }
    async function handleClick(event: Event): Promise<void> {
        event.preventDefault(); // Prevenir el comportamiento por defecto del botón de formulario
        const numeroWhastapp = document.getElementById('numeroWhastapp') as HTMLInputElement;
        const plan = document.getElementById('plan') as HTMLSelectElement;

        const numeroWhastapp1 = numeroWhastapp.value;
        const plan1 = plan.value;

        const data = {
            tel: numeroWhastapp1,
            plan: plan1
        };
        if (!validatePhoneNumber(numeroWhastapp1)) {
                alert("numero no valido")
                return;
            } else {
                
            }
        console.log(`Número de WhatsApp: ${numeroWhastapp1}`);
        console.log(`Plan: ${plan1}`);
        alert('En un momento le llegará un mensaje por WhatsApp. Si no es así, por favor comuníquese por teléfono o WhatsApp.');
        try {
            const response = await fetch('https://beautiful-icy-monday.glitch.me/pruebapagweb', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
        } catch (error) {
            console.error('Error:', error);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const button = document.getElementById('formulario');
        if (button) {
            button.addEventListener('click', handleClick);
        }
    });
</script>


<Layout title="OnFiber Empresarial" heroImage='/background-paquetes.png'>
    <main class="flex flex-col h-full  w-full ">
        <h1 class="text-3xl md:text-2xl lg:text-4xl mb-3 tracking-wides text-center">CONTRATAR</h1>
		<div class="flex flex-col text-center md:px-11 lg:px-5 xl:px-10  h-auto lg:mb-1 xl:h-full w-full justify-center">
            
                <div class="w-full flex flex-col lg:flex-row gap-2 justify-center">
                    <CardPaquetesContratar title="PLAN BASICO" mbps="30 Megas" price="300" desc='Ideal para navegar en internet, usar redes sociales y ver videos en calidad estándar en hogares pequeños.'/>
                    <CardPaquetesContratar title="PLAN INTERMEDIO" mbps="70 Megas" price="350" desc='Ideal para familias que ven videos en alta definición y juegan en línea sin problemas.'/>
                    <CardPaquetesContratar title="PLAN PRO" mbps="100 Megas" price="450" desc='Ideal para trabajar desde casa, hacer videollamadas sin interrupciones y disfrutar de streaming en 4K.'/>
                    <CardPaquetesContratar title="PLAN MASTER PRO" mbps="200 Megas" price="550" desc='Ideal para usuarios y negocios que necesitan internet muy rápido para tareas pesadas y muchos usuarios al mismo tiempo.'/>
                </div>
		</div>
        <div class="flex flex-col justify-center h-full items-center">
            <form class="p-2 flex flex-col  items-center gap-1 md:gap-3 ">
                <div class="flex flex-row items-center w-full justify-center gap-2">
                    <p class="text-base text-start color-principal">ELIJE EL PLAN QUE NECESITAS:</p>
                    <select id="plan" class="bg-white bg-opacity-5 backdrop-blur-sm border-2 rounded-lg text-white py-1 px-4 w-2/3 max-w-xs focus:outline-none focus:border-white">
                        <option class="bg-black text-white" value="basico">30 Megas</option>
                        <option class="bg-black text-white" value="intermedio">70 Megas</option>
                        <option class="bg-black text-white"value="pro">100 Megas</option>
                        <option class="bg-black text-white"value="master-pro">200 Megas</option>
                    </select>
                </div>
                <div class="p-2 flex flex-col lg:flex-row items-center gap-1">
                    <label class="text-center text-white text-base mt-2 lg:mt-0 lg:ml-2">
                        INTRODUCE TU NÚMERO DE WHATSAPP, TE CONTACTAREMOS EN MENOS DE UN MINUTO.
                    </label>
                    <div class="flex flex-row gap-1 mt-2 lg:mt-0">
                        <input id="numeroWhastapp" type="text" placeholder="Núm de WhatsApp" class="bg-white bg-opacity-5 backdrop-blur-sm border-2 rounded-lg text-white py-1 px-4 w-2/3 max-w-xs focus:outline-none focus:border-white">
                        <button id="formulario" type="submit" class="bg-gray-300 text-black rounded-lg py-1 px-4 hover:bg-gray-400">ENVIAR</button>
                    </div>
                </div>
                
            </form>
            <p class="text-base mt-2">LLÁMANOS: <a href="tel:4493880998" class="color-principal">449 388 09 98</a></p>
            <p class="text-base mt-2">WHATSAPP: <a href="https://api.whatsapp.com/send?phone=5214493275135&text=Hola!%2C%20me%20interesa%20contratar%20su%20servicio." class="color-principal">449 388 09 98</a></p>
        </div>
        <div class="flex flex-grow ">
            
        </div>
		<div>
			<div class="flex flex-row justify-center w-full md:w-2/3 lg:w-1/2 m-auto">
				<EmpresarialButton/>
				<HomeButton/>
				<TestimoniosButton/>
			</div>
		</div>
        
    </main>
</Layout>

<style>
	main {
		margin: 0;
		padding: .3rem; 
        padding-top: 0; 
		max-width: calc(100% - 2rem);
		color: white;
		font-size: 20px;
		line-height: 1.6;
	}
    .color-principal{
        color: #D3A7E4;
    }
</style>
